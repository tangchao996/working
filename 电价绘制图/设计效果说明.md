# 电价趋势分析图 - 设计效果说明 🎨

## 📐 整体布局

生成的图表采用**四层垂直布局**，总尺寸为 20×16 英寸，300 DPI 高清输出：

```
┌─────────────────────────────────────────────────────┐
│  🎯 关键指标卡片区 (顶部)                              │
├─────────────────────────────────────────────────────┤
│                                                     │
│  📈 主趋势图区 (中上)                                │
│                                                     │
├─────────────────────────────────────────────────────┤
│  📊 价差柱状图区 (中下)                              │
├─────────────────────────────────────────────────────┤
│  📋 统计信息与洞察面板 (底部)                         │
└─────────────────────────────────────────────────────┘
```

---

## 🎯 第一层：关键指标信息卡（顶部）

### 设计特点
- **4张圆角卡片**并排展示，采用浅灰背景 (#f8fafc)，边框颜色 #e2e8f0
- 每张卡片包含：
  - **标题**（灰色，11号字）
  - **核心数值**（深色加粗，20号字）
  - **副标题/补充信息**（浅灰色，10.5号字）

### 四张卡片内容

```
┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐
│日前均价   │ │实时均价   │ │平均价差   │ │相关系数   │
│ 365.78   │ │ 374.21   │ │  8.43    │ │ 0.83     │
│波动率x.x%│ │波动率x.x%│ │价差σ xx.x│ │溢价率x.x%│
└──────────┘ └──────────┘ └──────────┘ └──────────┘
```

### 视觉效果
- 现代化的"仪表盘"风格
- 一眼即可看到最关键的4个指标
- 圆角卡片设计，层次分明

---

## 📈 第二层：主趋势图（中上区域）

### 标题
**"日前与实时均价走势"** - 18号加粗字体，深灰色

### 背景色
- 浅蓝色背景 (#f9fbfd)，营造专业感

### 图表元素

#### 1. 价格趋势线
- **日前均价线**：深青色 (#005f73)，圆形标记点 (○)，线宽2.4
- **实时均价线**：深红色 (#ae2012)，方形标记点 (□)，线宽2.4
- 标记点带白色边框，更醒目

#### 2. 均值参考线
- **日前均值虚线**：深青色虚线，标注数值 "日前均价均值: XXX.XX"
- **实时均值虚线**：深红色虚线，标注数值 "实时均价均值: XXX.XX"

#### 3. 置信区间（标准差范围）
- 日前价格 ±1σ 区域：浅青色半透明填充
- 实时价格 ±1σ 区域：浅红色半透明填充

#### 4. 价差区间填充
- 两条价格线之间的区域用**薄荷绿色** (#94d2bd) 半透明填充
- 直观展示每日价差范围

#### 5. 关键点高亮标注 ⭐
采用**白色空心圆圈**突出显示，外圈带颜色边框：
- **日前峰值点** - 上方标注 "日前峰值\nXXX.XX"
- **日前低点** - 下方标注 "日前低点\nXXX.XX"
- **实时峰值点** - 上方标注 "实时峰值\nXXX.XX"  
- **实时低点** - 下方标注 "实时低点\nXXX.XX"

#### 6. 数据标签（可选）
- 每隔若干个点显示精确数值
- 颜色与对应线条一致
- 半透明显示 (alpha=0.85)

#### 7. 图例
- 位于左上角
- 白色背景，浅灰边框
- 两列显示，紧凑布局

### 视觉效果示意
```
日前与实时均价走势
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
                  ⭕ 实时峰值
               ⬤  550.50
           ⬤      
       ⬤              ⬤
   ⬤                      ⬤
⬤ ━━━━━━━━━━━━━━━━━━━━━━ 实时均值 ━━━
           ○    ○
       ○              ○
   ○  ⭕ 日前峰值        ○
━━━━━━━━━━━━━━━━━━━━━━ 日前均值 ━━━
                              ⭕ 日前低点
06/29  07/05  07/15  07/25  08/02
```

---

## 📊 第三层：价差分析柱状图（中下区域）

### 背景色
- 浅黄色背景 (#fefce8)，与主趋势图区分

### Y轴标题
**"价差 (元/MWh)"** - 14号加粗

### X轴标题  
**"日期"** - 14号加粗，每日显示为 MM/DD 格式

### 柱状图设计
- **正溢价柱**（实时>日前）：青绿色 (#2a9d8f)
- **负溢价柱**（实时<日前）：橙红色 (#e76f51)
- 柱子带白色边框，宽度0.7

### 参考线
- **零值线**：深灰色实线，alpha=0.6
- **平均价差线**：深灰色虚线，标注 "平均价差: XX.XX"

### 极值标注
- **最大正溢价点**：青绿色圆点标记，上方标注数值
- **最大负溢价点**：橙红色圆点标记，下方标注数值

### 视觉效果示意
```
价差 (元/MWh)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
          ⭕ 最大正溢价
200       ║   244.22
          ║
100       ║  ║    ║
          ║  ║    ║  ║
─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ 平均价差
0   ║  ║ ║  ║    ║  ║  ║
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
-100      ║           ║
          ⭕ 最大负溢价
-150      -97.87
    06/29    07/15    08/02
           日期
```

---

## 📋 第四层：统计信息与洞察面板（底部）

### 左侧：统计摘要表格
**标题**："—— 核心统计摘要 ——"

**内容**：等宽字体 (monospace) 显示的统计表
```
周期: 35 天 (2025-06-29 → 2025-08-02)

指标        日前均价    实时均价        价差
────────────────────────────────────────────
均值         365.78      374.21        8.43
标准差        72.45       67.89       56.32
最小值       230.01      209.47      -97.87
最大值       546.51      550.50      244.22
```

**样式**：
- 浅灰背景 (#f8fafc)
- 浅灰边框 (#e2e8f0)
- 圆角边框
- 11号等宽字体

### 右侧：智能洞察面板
**标题**：自动生成的关键洞察点，每条以 "•" 开头

**内容示例**：
```
• 实时价格峰值出现在 06月29日（550.50 元/MWh）

• 最大正溢价发生在 06月29日，价差 244.22 元/MWh

• 最大负溢价发生在 07月25日，价差 -93.87 元/MWh

• 实时价格与日前价格的相关性为 0.834，平均溢价率 2.30%
```

**样式**：
- 浅橙色背景 (#fff7ed)
- 橙色边框 (#fed7aa)
- 圆角边框
- 11.5号字体，深灰色文字

---

## 🎨 配色方案总结

### 主题色
| 用途 | 颜色代码 | 颜色名称 |
|------|---------|---------|
| 日前均价 | #005f73 | 深青色 |
| 实时均价 | #ae2012 | 深红色 |
| 正溢价 | #2a9d8f | 青绿色 |
| 负溢价 | #e76f51 | 橙红色 |
| 价差区间 | #94d2bd | 薄荷绿 |

### 背景色
| 区域 | 颜色代码 | 色调 |
|------|---------|------|
| 信息卡片 | #f8fafc | 浅灰 |
| 主趋势图 | #f9fbfd | 浅蓝 |
| 价差图 | #fefce8 | 浅黄 |
| 统计面板 | #f8fafc | 浅灰 |
| 洞察面板 | #fff7ed | 浅橙 |

### 文字色
| 用途 | 颜色代码 | 描述 |
|------|---------|------|
| 主标题 | #0f172a | 深黑 |
| 次级标题 | #1f2937 | 深灰 |
| 普通文字 | #334155 | 中灰 |
| 辅助文字 | #475569 | 浅灰 |
| 次要文字 | #64748b | 更浅灰 |

---

## ✨ 设计亮点

### 1. 信息层次清晰
- **顶部**：关键指标一目了然
- **中部**：详细趋势和价差分析  
- **底部**：完整统计数据和智能洞察

### 2. 视觉焦点突出
- 使用**白色空心圆圈**标注极值点
- 颜色对比鲜明但不刺眼
- 重要信息自然吸引视线

### 3. 配色专业协调
- 采用 Tailwind CSS 配色体系
- 冷暖色搭配平衡
- 背景色微妙区分各区域

### 4. 数据密度适中
- 信息丰富但不拥挤
- 合理的留白和间距
- 可读性极佳

### 5. 适合多场景使用
- **屏幕查看**：高DPI清晰显示
- **打印输出**：300 DPI专业品质
- **演示文稿**：层次分明易于讲解
- **报告嵌入**：信息完整自成体系

---

## 📊 与原版对比

### 原版特点
- 三层布局（主图、价差图、统计面板）
- 统计信息以单一文本块呈现
- 简洁但信息密度较低

### 新版改进 ✅
1. **新增顶部KPI卡片区**：最关键的4个指标卡片式展示
2. **极值点白色空心圆标注**：视觉焦点更突出
3. **价差区间填充**：两条价格线之间薄荷绿填充
4. **背景色区分**：每个区域使用不同浅色背景
5. **双栏统计面板**：左侧统计表 + 右侧智能洞察
6. **增强数据标注**：价差图标注最大正负溢价
7. **更多统计指标**：波动率、溢价率、相关系数等
8. **智能洞察生成**：自动生成关键事件描述

---

## 🚀 使用方式

### 查看生成的图表
图表已保存在：
```
/home/engine/project/电价绘制图/电价趋势分析图_专业版.png
```

### 重新生成
```bash
cd /home/engine/project/电价绘制图
.venv/bin/python 电价趋势图绘制.py
```

### 自定义参数
编辑 `电价趋势图绘制.py`，修改函数调用：
```python
fig, axes = plot_daily_price_trend(
    df_from_excel,
    save_path=save_location,
    show_labels=True,      # 是否显示数据标签
    figsize=(20, 16)       # 图表尺寸
)
```

---

## 💡 最佳实践建议

1. **数据量 < 30天**：保持 `show_labels=True`，显示所有数据标签
2. **数据量 30-60天**：保持默认设置，自动稀疏标注
3. **数据量 > 60天**：设置 `show_labels=False`，仅显示极值标注
4. **高清打印**：保持 figsize=(20, 16)，确保300 DPI输出
5. **演示文稿**：可适当缩小尺寸为 (16, 12)

---

## 📝 技术实现要点

### 布局技术
- 使用 `GridSpec` 实现灵活的多层布局
- 高度比例：0.65 : 3.1 : 1.6 : 1.2

### 绘图技术
- `FancyBboxPatch` 实现圆角卡片
- `fill_between` 实现区间填充
- `scatter` + `annotate` 实现极值标注
- `sharex` 实现子图间X轴共享

### 数据处理
- 自动计算均值、标准差、极值
- 动态计算波动率 (CV)、溢价率
- 智能生成洞察文本

---

生成的图表文件大小约 **1.1 MB**，分辨率极高，适合各种专业用途！🎉
