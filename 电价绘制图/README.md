# 电价趋势分析图生成工具

这是一个用于生成专业电价趋势分析图表的Python工具。

## 功能特性

- 绘制日前均价与实时均价的趋势线
- 动态计算并展示均值线和标准差范围（置信区间）
- 添加精确到两位小数的数据标签
- 创建独立的价差分析子图
- 集成专业的统计信息面板
- 支持中文字体显示
- 自动格式化X轴日期

## 文件说明

- `电价趋势图绘制.py` - 主程序脚本
- `每日电价分享.xlsx` - 输入数据文件
- `电价趋势分析图_专业版.png` - 输出的图表文件
- `趋势图.png` - 历史生成的图表

## 使用方法

### 安装依赖

```bash
pip install pandas matplotlib numpy seaborn openpyxl
```

可选依赖（用于优化数据标签布局）：
```bash
pip install adjustText
```

### 运行脚本

```bash
cd 电价绘制图
python 电价趋势图绘制.py
```

脚本会自动读取同目录下的 `每日电价分享.xlsx` 文件，并生成 `电价趋势分析图_专业版.png`。

如果找不到Excel文件，脚本会使用内置的演示数据生成示例图表。

## 数据格式要求

Excel文件应包含三列：
1. 日期 - 日期格式（如：2025/6/29）
2. 日前均价 - 数值型
3. 实时均价 - 数值型

## 输出说明

生成的图表包含三个部分：
1. **主趋势图** - 显示日前均价和实时均价的变化趋势，包含均值线和置信区间
2. **价差分析图** - 以柱状图形式展示每日价差（实时均价 - 日前均价）
3. **统计信息面板** - 展示核心统计数据和市场关联性指标
